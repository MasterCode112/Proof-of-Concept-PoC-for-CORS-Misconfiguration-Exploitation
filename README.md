# Proof-of-Concept-PoC-for-CORS-Misconfiguration-Exploitation
Cross-Origin Resource Sharing (CORS) is a security feature implemented by web browsers to prevent malicious websites from making unauthorized requests to other websites on behalf of a user. It allows web applications running at one origin (domain) to interact with resources from another origin securely

This step-by-step guide explains how to perform a Proof of Concept (PoC) attack to exploit the Cross-Origin Resource Sharing (CORS) misconfiguration. The goal is to demonstrate how a malicious website can send an authenticated request to a vulnerable server and retrieve sensitive information using the victim’s session credentials.

Pre-requisites:
A vulnerable website with misconfigured CORS (in this case, victim.com).
A domain (attacker's domain) that is allowed in the vulnerable site's Access-Control-Allow-Origin header (e.g., mastercode.com).
Victim’s session credentials (cookies or tokens) should already be available in the browser.
Objective:
Exploit the misconfigured CORS to make cross-origin requests from an attacker-controlled domain to the vulnerable server using the victim’s session, and retrieve sensitive data.

Steps to Perform the Attack:
Step 1: Prepare an Attacker-Controlled Webpage
Set up a Web Server on your attacker domain (https://mastercode.com).

You can use platforms like GitHub Pages, Python’s simple HTTP server, or any web hosting provider.
Create a Malicious HTML/JavaScript File that will make the cross-origin request to the vulnerable endpoint (victim.com) using the victim's credentials.

Here is the sample HTML/JavaScript code:

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MasterCode Cors</title>
</head>
<body>
<script>
var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        alert(xhttp.responseText);
    }

    alert(xhttp.responseText);
};

xhttp.open("GET", "https://victim/sensitve data", true);
xhttp.withCredentials = true; // Corrected line
xhttp.send();
</script>
</body>
</html>
```
This script sends a request to the vulnerable endpoint (https://victim.com/api/v1/auth/enforce), retrieves the response, and then logs the data to a remote server controlled by the attacker (https://attacker.com).

Step 2: Host the Malicious Page
Upload or Host the Malicious HTML File you created on your attacker-controlled domain (https://mastercode.com).

Ensure that your malicious website is live and accessible via the internet.

Step 3: Trick the Victim into Visiting the Malicious Page
Craft a Social Engineering Attack:

You can send a phishing email or use social media to trick the victim into visiting the malicious webpage on https://mastercode.com.
Victim Visits the Page:

When the victim opens the page on their browser while logged into victim.com, their session cookies will be automatically sent to the vulnerable server via the CORS request.
Step 4: Capture the Response from the Vulnerable Server
Observe the Response:

The malicious script will use the victim’s session to make an authenticated request to the vulnerable server (victim.com).
Once the request is successful, the server will send back a response that the attacker can log.
Log the Data:

In this example, the response data is sent to https://attacker.com/log, where the attacker can store or view the stolen data.
Proof of Concept:

Once the attacker receives sensitive information (such as session tokens, personal data, etc.), it proves that the CORS misconfiguration is exploitable.
Step 5: Analyze and Report the Findings
Analyze the Captured Data:

Check the response returned by the vulnerable site. This could include sensitive information such as session tokens, account details, or other private data.
Document the Attack:

Clearly document each step, the exploited misconfiguration, and the retrieved data.
Report the Issue:

Submit the findings as part of a responsible disclosure report or penetration test report. Include all relevant details, including the steps taken, the result, and a recommendation for fixing the vulnerability.
Recommendations to Prevent the Attack:
Limit CORS Access:

Ensure that the Access-Control-Allow-Origin header is configured to allow only trusted origins.
If no external domain should access the resource, do not allow any CORS request.
Disable Access-Control-Allow-Credentials:

Disable the Access-Control-Allow-Credentials flag if cross-origin requests do not need to include cookies or credentials.
Implement Proper Access Controls:

Add checks on the server side to ensure that only authorized domains can perform requests on behalf of authenticated users.
Audit CORS Configuration Regularly:

Regularly review and audit CORS settings for potential misconfigurations and remove any unnecessary origins.
By following these steps, you can perform a CORS misconfiguration PoC attack and provide evidence of the vulnerability for mitigation.
